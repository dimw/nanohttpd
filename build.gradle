plugins {
	id 'java'
	id 'maven-publish'
}

allprojects {
	apply plugin: 'java'
	apply plugin: 'idea'

	group = 'org.nanohttpd'
	version = '2.3.2-SNAPSHOT'
}

java {
	sourceCompatibility = 1.7
	targetCompatibility = 1.7
}

subprojects {
	apply plugin: 'java-library'
	apply plugin: 'maven-publish'

	repositories {
		mavenCentral()
	}

	publishing {
		publications {
			maven(MavenPublication) {
				groupId project.group
				artifactId project.name
				version = project.version

				from components.java
			}
		}

		repositories {
			maven {
				name = "GitHubPackages"
				url = "https://maven.pkg.github.com/dimw/nanohttpd"
				credentials {
					username = System.getenv("GITHUB_ACTOR")
					password = System.getenv("GITHUB_TOKEN")
				}
			}
		}
	}

	dependencies {
		testImplementation group: 'junit', name: 'junit', version: '4.12'
	}
}
